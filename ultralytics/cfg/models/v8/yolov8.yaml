# Ultralytics ðŸš€ AGPL-3.0 License - https://ultralytics.com/license
# Ultraâ€‘light realâ€‘time indexâ€‘finger pose (YOLOv8n) with Efficient Channel Attention

# Parameters
nc: 1                   # single class (hand/finger)
kpt_shape: [21,3]      # 21 hand keypoints (x,y,confidence)
scale: "n"            # Nano scale for minimal footprint

# Backbone (P1â†’P5) using depthwise separable convolutions and ECA attention
backbone:
  - [-1, 1, Conv,      [32, 3, 2]]       # 0 â†’ P1/2 (32 channels)
  - [-1, 1, DWConv,    [32, 3, 1]]       # 1 â†’ deeper spatial
  - [-1, 1, ECA,       [32]]             # 2 â†’ ECA at P2
  - [-1, 1, Conv,      [64, 3, 2]]       # 3 â†’ P3/4 (64 channels)
  - [-1, 1, DWConv,    [64, 3, 1]]       # 4
  - [-1, 1, ECA,       [64]]             # 5 â†’ ECA at P3
  - [-1, 1, Conv,      [128, 3, 2]]      # 6 â†’ P4/8 (128 channels)
  - [-1, 1, DWConv,    [128,3,1]]       # 7
  - [-1, 1, Conv,      [256,3,2]]       # 8 â†’ P5/16 (256 channels)
  - [-1, 1, SPPF,      [256,5]]         # 9 â†’ spatial pooling

# Head (FPN + Pose)
head:
  # Merge P5â†’P4â†’P3
  - [-1,1,  nn.Upsample, [None,2,'nearest']]  # 10
  - [[10,7],1, Concat, [1]]                   # 11: fuse with P4
  - [-1,1,  DWConv, [128,3,1]]                # 12
  - [-1,1,  nn.Upsample, [None,2,'nearest']]  # 13
  - [[13,5],1, Concat, [1]]                   # 14: fuse with P3
  - [-1,1,  DWConv, [64,3,1]]                 # 15

  # Single high-res P2 pose head
  - [1, 1, Conv,      [32, 3, 1]]             # 16: project P2 features
  - [16,1, Pose,      [nc, kpt_shape]]        # 17: P2 keypoint regression

# End of ultra-light YOLOv8n-pose configuration
